live-live mark scheme 

1 - loading in CSV files
1 - loading in correct column type

t1:("PSSFI";enlist",")0:`:t1.csv;
t2:("PSSFI";enlist",")0:`:t2.csv

1 - report on nulls
1 - flip and join null tables

null1:select sum_nulls_t1:sum(sum size;sum time;sum price;sum sym;sum src) from null t1;
null2:select sum_nulls_t2:sum(sum size;sum time;sum price;sum sym;sum src) from null t2;
0N!flip (flip null1),flip null2

1 - backfill nulls, or delete rows with nulls from data

t1:fills t1;
t2:fills t2;

delete from `t1 where (time=0Np)or(sym=`)or(src=`)or(price=0n)or(size=0N);                                                    
delete from `t2 where (time=0Np)or(sym=`)or(src=`)or(price=0n)or(size=0N)

1 - function to query table 1 and 2 for OHLC
1 - join tables together with correct columns 

ohlc:{[tab1;tab2]
 t1:select open1:first price, high1:max price, low1:min price, close1:last price by sym from tab1;
 t2:select open2:first price, high2:max price, low2:min price, close2:last price by sym from tab2;
 ohlc:t1 uj t2;
 1!`sym`open1`open2`high1`high2`low1`low2`close1`close2 xcols 0!ohlc 
 }

1 - make a function that gets the trades and quotes from t1 and t2

each_date:{[hdb1;hdb2;date1] / works
 / get trades data for that day
 t1:hdb1({?[`trades;enlist(=;`date;x);0b;()]};date1);
 q1:hdb1({?[`quotes;enlist(=;`date;x);0b;()]};date1);
 t2:hdb2({?[`trades;enlist(=;`date;x);0b;()]};date1);
 q2:hdb2({?[`quotes;enlist(=;`date;x);0b;()]};date1);

1 - call the OHLC function with t1 and t2

 .live.ohlctab:ohlc[t1;t2];

2 - query to find the spread of the tables

 spread_tab:?[`.live.ohlctab;();(enlist `sym)!enlist `sym;`spread1`spread2!((-;`open1;`close1);(-;`open2;`close2))];

2 - find out which table has the smaller spread

 s1:raze exec spread1 from spread_tab;
 s2:raze exec spread2 from spread_tab;
 which_hdb:$[(sum abs s1)<(sum abs s2);1;2];

1 - save the table with the smaller spread

 .live.tradetab:$[which_hdb=1;t1;t2];
 .live.quotetab:$[which_hdb=1;q1;q2];

1 - save trades and quotes table to disk
1 - set the trades and quotes table to the global namespace

 {.Q.dpft[`:newhdb;x;`sym;`trades set .live.tradetab]}date1; 
 {.Q.dpft[`:newhdb;x;`sym;`quotes set .live.quotetab]}date1; 
 }

1 - comparison function, open ports to both hdb

hdbcompare:{[hdbport1;hdbport2]
 hdb1:hopen hdbport1; hdb2:hopen hdbport2;

1 - query for distinct dates and call each_date function for date range

 dates: raze value flip hdb1"select distinct date from trades";
 each_date[hdb1;hdb2] each dates;
 hclose hdb1; hclose hdb2;
 }
